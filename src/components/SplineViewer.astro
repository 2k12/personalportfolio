---
import GitHubIcon from "../icons/GitHub.astro";
import LinkedInIcon from "../icons/LinkedIn.astro";
import MailIcon from "../icons/Mail.astro";
import SocialPill from "../icons/SocialPill.astro";
import SectionContainer from "../components/SectionContainer.astro";

// --- Iconos para la biografía (mejor que emojis) ---
const BriefcaseIcon = `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="size-5 text-white/80"><path stroke-linecap="round" stroke-linejoin="round" d="M20.25 14.15v4.007a2.25 2.25 0 0 1-2.25 2.25h-12a2.25 2.25 0 0 1-2.25-2.25v-4.007M12 10.75h.008v.008H12v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z" /></svg>`;

const GraduationCapIcon = `<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="size-5 text-white/80"><path stroke-linecap="round" stroke-linejoin="round" d="M4.26 10.147a60.438 60.438 0 0 0-.491 6.347A48.627 48.627 0 0 1 12 20.904a48.627 48.627 0 0 1 8.232-4.41 60.46 60.46 0 0 0-.491-6.347m-15.482 0a50.57 50.57 0 0 0-2.658-.813A59.906 59.906 0 0 1 12 3.493a59.906 59.906 0 0 1 10.399 5.84c-1.033.25-2.096.423-3.21.513m-13.065 0C3.42 9.98 3.322 9.873 3.228 9.75c-.217-.288-.425-.59-.622-.916a25.068 25.068 0 0 1 11.19-4.43c.128.056.255.113.38.172a25.068 25.068 0 0 1 11.19 4.43c-.197.326-.405.628-.622.916-.094.123-.192.23-.288.33m-13.065 0c.288-.26.59-.516.904-.76 1.033-.824 2.152-1.558 3.324-2.164a25.068 25.068 0 0 1 4.268 0c1.172.606 2.291 1.34 3.324 2.164.314.244.616.5.904.76" /></svg>`;
---

<div class="hero-container">
  <canvas id="particle-canvas"></canvas>
</div>

<style>
  .hero-container {
    width: 100%;
    height: 100%;
    position: absolute;
    inset: 0;
    overflow: hidden;
  }

  #particle-canvas {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1;
    pointer-events: none;
  }
</style>

<script>
  import * as THREE from "three";

  document.addEventListener("DOMContentLoaded", () => {
    // --- CAMBIO 9: Lógica de Switch Eliminada ---
    // Todo el código de 'image1', 'image2', 'switchButton' se ha ido.

    // --- CAMBIO 10: Inicialización de Three.js Limpia ---
    const canvas = document.getElementById(
      "particle-canvas",
    ) as HTMLCanvasElement | null;
    if (!canvas) return;

    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(
      75,
      window.innerWidth / window.innerHeight,
      0.1,
      1000,
    );
    const renderer = new THREE.WebGLRenderer({
      canvas: canvas, // Pasamos el canvas directamente
      antialias: true,
      alpha: true,
    });

    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
    // Ya no necesitamos 'container.appendChild(renderer.domElement);'

    const particlesCount = 5000;
    const positions = new Float32Array(particlesCount * 3);
    for (let i = 0; i < particlesCount * 3; i++) {
      positions[i] = (Math.random() - 0.5) * 10;
    }
    const particlesGeometry = new THREE.BufferGeometry();
    particlesGeometry.setAttribute(
      "position",
      new THREE.BufferAttribute(positions, 3),
    );
    const particlesMaterial = new THREE.PointsMaterial({
      size: 0.02,
      color: 0xffffff,
    });
    const particleSystem = new THREE.Points(
      particlesGeometry,
      particlesMaterial,
    );
    scene.add(particleSystem);
    camera.position.z = 5;

    // --- Lógica de Parallax (Sin cambios, es buena) ---
    const mouse = new THREE.Vector2();
    window.addEventListener("mousemove", (event) => {
      mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
      mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
    });

    const clock = new THREE.Clock();
    const animate = () => {
      requestAnimationFrame(animate);

      // --- CAMBIO 11: Rotación más sutil ---
      particleSystem.rotation.y = clock.getElapsedTime() * 0.05; // Más lento

      // El efecto parallax de la cámara está genial
      camera.position.x += (mouse.x * 0.5 - camera.position.x) * 0.02;
      camera.position.y += (mouse.y * 0.5 - camera.position.y) * 0.02;

      camera.lookAt(scene.position);
      renderer.render(scene, camera);
    };

    window.addEventListener("resize", () => {
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
      renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
    });

    animate();
  });
</script>
